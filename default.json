{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "enabled": true,
  "description": "Default Renovate config used by @Kiruyuto",
  "extends": [
    "config:recommended",
    ":gitSignOff",
    ":dependencyDashboard",
    ":disableRateLimiting",
    "helpers:pinGitHubActionDigests"
  ],
  "schedule": [
    "at any time"
  ],
  "labels": [
    "dependencies"
  ],
  "dependencyDashboardLabels": [
    "dependencies"
  ],
  "rangeStrategy": "bump",
  "commitBodyTable": true,
  "configMigration": true,
  "branchPrefix": "deps/",
  "prCreation": "immediate",
  "prBodyTemplate": "{{{header}}}{{{table}}}{{{warnings}}}{{{notes}}}{{{changelogs}}}{{{controls}}}{{{footer}}}",
  "dependencyDashboardFooter": "<h6>Renovate extends from Kiruyuto's default configuration. You can see all settings <a href=\"https://github.com/Kiruyuto/renovate-config/blob/master/default.json\">here</a></h6>\n\n- [ ] <!-- manual job -->Check this box to trigger a request for Renovate to run again on this repository",
  "commitMessageLowerCase": "never",
  "semanticCommits": "enabled",
  "semanticCommitScope": "dependencies",
  "rebaseWhen": "conflicted",
  "major": {
    "description": "Require dashboard approval for major updates",
    "automerge": false,
    "dependencyDashboardApproval": true
  },
  "patch": {
    "automerge": true,
    "automergeType": "branch",
    "automergeStrategy": "squash"
  },
  "minor": {
    "automerge": true,
    "automergeType": "branch",
    "automergeStrategy": "squash"
  },
  "lockFileMaintenance": {
    "enabled": true,
    "rebaseWhen": "behind-base-branch"
  },
  "vulnerabilityAlerts": {
    "enabled": true,
    "schedule": [
      "at any time"
    ],
    "dependencyDashboardApproval": false,
    "rangeStrategy": "update-lockfile",
    "commitMessageSuffix": "[SECURITY]",
    "branchTopic": "{{{datasource}}}-{{{depNameSanitized}}}-vulnerability",
    "prCreation": "immediate",
    "automerge": false,
    "labels": [
      "security"
    ]
  },
  "packageRules": [
    {
      "description": "Always use 'chore' for semantic commit type",
      "matchFileNames": [
        "**/*"
      ],
      "semanticCommitType": "chore"
    },
    {
      "description": "Group all GitHub Actions updates into single PR",
      "matchFileNames": [
        ".github/workflows/**"
      ],
      "additionalBranchPrefix": "gh-actions-",
      "commitMessageSuffix": "(ci)",
      "matchDepNames": [
        "!dotnet-sdk"
      ]
    },
    {
      "description": "Group all Docker updates into single PR",
      "matchDatasources": [
        "docker"
      ],
      "additionalBranchPrefix": "docker-",
      "commitMessageSuffix": "(docker)",
      "matchPackageNames": [
        "!mcr.microsoft.com/dotnet/aspnet",
        "!mcr.microsoft.com/dotnet/sdk",
        "!mcr.microsoft.com/dotnet/runtime",
        "!mcr.microsoft.com/dotnet/runtime-deps",
        "!mcr.microsoft.com/dotnet/aspire-dashboard"
      ]
    },
    {
      "description": "Group all .NET major version updates together",
      "groupName": ".NET Major Version",
      "matchDatasources": [
        "dotnet-version",
        "custom.dotnet-channel",
        "docker",
        "nuget"
      ],
      "matchUpdateTypes": [
        "major"
      ],
      "commitMessageTopic": ".NET",
      "additionalBranchPrefix": "dotnet-",
      "commitMessageSuffix": "(dotnet)"
    },
    {
      "description": "Group all .NET minor and patch updates together",
      "groupName": ".NET Minor/Patch Updates",
      "matchDatasources": [
        "dotnet-version",
        "custom.dotnet-channel",
        "docker",
        "nuget"
      ],
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "commitMessageTopic": ".NET",
      "additionalBranchPrefix": "dotnet-",
      "commitMessageSuffix": "(dotnet)"
    },
    {
      "description": "Pin only NPM packages. Otherwise bump. Prevents errors with dotnet & docker builds. Additionally, group them into separate PRs",
      "matchDatasources": [
        "npm"
      ],
      "rangeStrategy": "pin",
      "additionalBranchPrefix": "npm-",
      "commitMessageSuffix": "(npm)"
    },
    {
      "description": "Group all Node.js updates into single PR",
      "matchDatasources": [
        "node-version"
      ],
      "additionalBranchPrefix": "node-",
      "commitMessageSuffix": "(node)"
    },
    {
      "description": "Group all remaining non-major dependencies",
      "groupName": "all non-major dependencies",
      "matchUpdateTypes": [
        "minor",
        "patch"
      ],
      "matchDatasources": [
        "!(nuget)"
      ],
      "matchDepNames": [
        "!dotnet-sdk",
        "!TargetFramework",
        "!mcr.microsoft.com/dotnet/aspnet",
        "!mcr.microsoft.com/dotnet/sdk",
        "!mcr.microsoft.com/dotnet/runtime",
        "!mcr.microsoft.com/dotnet/runtime-deps",
        "!mcr.microsoft.com/dotnet/aspire-dashboard"
      ]
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Match dotnet-version in github workflows",
      "managerFilePatterns": [
        "/^\\.github/workflows/.+?\\.yaml$/",
        "/^\\.github/workflows/.+?\\.yml$/"
      ],
      "matchStrings": [
        "dotnet-version:\\s+(?<currentValue>\\S+)"
      ],
      "depTypeTemplate": "dotnet",
      "datasourceTemplate": "dotnet-version",
      "depNameTemplate": "dotnet-sdk",
      "versioningTemplate": "semver-coerced"
    },
    {
      "customType": "regex",
      "description": "Match .nuspec <dependency> tag",
      "managerFilePatterns": [
        "/\\.nuspec$/"
      ],
      "matchStringsStrategy": "any",
      "matchStrings": [
        "<dependency\\s+id=\"(?<depName>.*?)\"\\s+version=\"(?<currentValue>.*?)\"\\s*\\/>"
      ],
      "datasourceTemplate": "nuget",
      "versioningTemplate": "nuget"
    },
    {
      "customType": "regex",
      "description": "Match <TargetFramework/> in .NET project files",
      "managerFilePatterns": [
        "/^Directory\\.Build\\.props$/",
        "/\\.csproj$/"
      ],
      "matchStrings": [
        "<TargetFramework>net(?<currentValue>\\d+\\.\\d+)</TargetFramework>"
      ],
      "depNameTemplate": "TargetFramework",
      "datasourceTemplate": "custom.dotnet-channel",
      "versioningTemplate": "loose"
    }
  ],
  "customDatasources": {
    "dotnet-channel": {
      "description": "Channel. Used for <TargetFramework/> updates in .NET project files",
      "defaultRegistryUrlTemplate": "https://dotnetcli.blob.core.windows.net/dotnet/release-metadata/releases-index.json",
      "transformTemplates": [
        "{\"releases\": `releases-index`.{\"version\": `channel-version`}}"
      ]
    }
  }
}